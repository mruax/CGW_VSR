====================================================================================================
ОТЧЕТ ОБ АНАЛИЗЕ ЛОГОВ GEANT4
====================================================================================================
Входной файл: logs/main120937.log
Дата анализа: 2025-10-31 01:41:00

1. ОБЩАЯ СТАТИСТИКА
----------------------------------------------------------------------------------------------------
Всего шагов: 702633
Первичные частицы (Parent ID = 0): 144934 шагов
Вторичные частицы (Parent ID > 0): 557699 шагов
Уникальных треков: 25
Уникальных потоков: 32
Типы частиц: e, gamma

2. СТАТИСТИКА ПО ЧАСТИЦАМ
----------------------------------------------------------------------------------------------------

ПЕРВИЧНЫЕ ЧАСТИЦЫ:
--------------------------------------------------

  Частица: e
    Количество шагов: 144934
    Количество треков: 1
    Средняя кинетическая энергия: 2.795884 MeV
    Диапазон энергий: [0.000000, 8.200000] MeV
    Сумма dEStep (> 0): 5134.129182 MeV
    Среднее dEStep (> 0): 0.038120 MeV

ВТОРИЧНЫЕ ЧАСТИЦЫ:
--------------------------------------------------

  Частица: gamma
    Количество шагов: 325874
    Количество треков: 20
    Средняя кинетическая энергия: 2.594356 MeV
    Диапазон энергий: [0.000000, 8.200000] MeV
    Сумма dEStep (> 0): 10933.793415 MeV
    Среднее dEStep (> 0): 0.036243 MeV

  Частица: e
    Количество шагов: 231825
    Количество треков: 24
    Средняя кинетическая энергия: 2.574162 MeV
    Диапазон энергий: [0.000000, 8.200000] MeV
    Сумма dEStep (> 0): 7868.924511 MeV
    Среднее dEStep (> 0): 0.036494 MeV

3. ЭНЕРГЕТИЧЕСКИЙ БАЛАНС
----------------------------------------------------------------------------------------------------

ПЕРВИЧНЫЕ ЧАСТИЦЫ:
  Начальная энергия: 8.200000 MeV
  Конечная энергия: 6.674000 MeV
  Потерянная энергия: 1.526000 MeV
  Сумма всех dEStep: 5134.129182 MeV
  Сумма положительных dEStep: 5134.129182 MeV

ВТОРИЧНЫЕ ЧАСТИЦЫ:
  Начальная энергия: 54.556450 MeV
  Конечная энергия: 38.069070 MeV
  Потерянная энергия: 16.487380 MeV
  Сумма всех dEStep: 18802.717925 MeV
  Сумма положительных dEStep: 18802.717925 MeV

4. СВЕРКА С ИТОГОВОЙ СВОДКОЙ
----------------------------------------------------------------------------------------------------
Energy deposit (из сводки): 4.279300 MeV
Energy leakage (из сводки): 3.920700 MeV
Сумма (E_deposit + E_leakage): 8.200000 MeV

⚠️  ВНИМАНИЕ: Лог неполный (пропущены шаги)!
Метод 1 (сумма dEStep) НЕ РАБОТАЕТ для неполных логов.
Используйте ТОЛЬКО Метод 2 (энергетический баланс).

Метод 1 (Сумма положительных dEStep - только потери энергии):
  Рассчитано: 23936.847107 MeV
  Абсолютная разница: 23932.567807 MeV
  Относительная разница: 559263.6134%
  ❌ НЕ ПРИМЕНИМО для этого лога (шаги пропущены)

Метод 2 (Начальная - Конечная энергия):
  Рассчитано: 18.013380 MeV
  Абсолютная разница: 13.734080 MeV
  Относительная разница: 320.9422%

Проверка энергетического баланса первичных частиц:
  Начальная энергия первичных: 8.200000 MeV
  E_deposit + E_leakage:       8.200000 MeV
  Разница:                     0.000000 MeV (0.0000%)

✅ ОТЛИЧНО! Энергетический баланс первичных частиц сходится (<1%)

5. СРАВНЕНИЕ ЧАСТОТ ПРОЦЕССОВ
----------------------------------------------------------------------------------------------------
Процесс                        |    Парсинг |     Сводка |    Разница
----------------------------------------------------------------------------------------------------
CoulombScat                    |     580834 |    1037570 |    -456736
initStep                       |      39595 |          0 |     +39595
eIoni                          |      31018 |      52756 |     -21738
Transportation                 |          0 |      16904 |     -16904
msc                            |      19403 |      34873 |     -15470
OutOfWorld                     |      10582 |          0 |     +10582
eBrem                          |      11439 |      20478 |      -9039
phot                           |       7864 |      11746 |      -3882
compt                          |       1283 |       1958 |       -675
Rayl                           |        546 |        842 |       -296
conv                           |         37 |         54 |        -17
annihil                        |         32 |         49 |        -17
Range                          |          0 |          3 |         -3
simulation                     |          0 |          3 |         -3
end                            |          0 |          3 |         -3
rms                            |          0 |          2 |         -2
true                           |          0 |          0 |         +0

6. ИНТЕРПРЕТАЦИЯ РЕЗУЛЬТАТОВ
----------------------------------------------------------------------------------------------------

ДВА МЕТОДА ПРОВЕРКИ ЭНЕРГЕТИЧЕСКОГО БАЛАНСА:

МЕТОД 1: Сумма потерь энергии (dEStep)
  • Суммирует все положительные значения dEStep из шагов
  • Работает ТОЛЬКО если ВСЕ шаги записаны в лог
  • ❌ НЕ РАБОТАЕТ для неполных логов (когда пропущены шаги)
  • Причина: если часть шагов не залогирована, сумма будет неполной

МЕТОД 2: Энергетический баланс треков (Начальная - Конечная)
  • Использует начальную и конечную энергию каждого трека
  • ✅ РАБОТАЕТ даже для неполных логов
  • Более надежный метод, не зависит от логирования промежуточных шагов

ПРОВЕРКА ЭНЕРГЕТИЧЕСКОГО БАЛАНСА:
  • Начальная энергия первичных частиц должна равняться
    сумме Energy deposit + Energy leakage из итоговой сводки
  • Это фундаментальный закон сохранения энергии
  • Если разница <1%, энергетический баланс сходится отлично

----------------------------------------------------------------------------------------------------

Первичные частицы (Parent ID = 0):
  • Это исходные частицы, запущенные в симуляции
  • Их начальная энергия - это входная энергия симуляции

Вторичные частицы (Parent ID > 0):
  • Это частицы, рожденные в процессе взаимодействия первичных
  • Они могут создаваться через процессы: ionIoni, eBrem, compt, и др.
  • Их энергия изначально взята из первичных частиц

Energy deposit:
  • Энергия, поглощенная материалом (ионизация)
  • Вызывает повреждения в материале

Energy leakage:
  • Энергия частиц, покинувших объем симуляции
  • Не поглощается материалом

Возможные причины малых расхождений (<5%):
  1. Округления при конверсии единиц (eV ↔ keV ↔ MeV)
  2. Численная точность при расчетах в Geant4
  3. NIEL energy (неионизирующие потери энергии)
  4. Энергетические пороги отслеживания частиц

====================================================================================================