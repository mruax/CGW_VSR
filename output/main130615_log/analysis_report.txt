====================================================================================================
ОТЧЕТ ОБ АНАЛИЗЕ ЛОГОВ GEANT4
====================================================================================================
Входной файл: logs/main130615.log
Дата анализа: 2025-10-31 02:29:54

1. ОБЩАЯ СТАТИСТИКА
----------------------------------------------------------------------------------------------------
Всего шагов: 2296928
Первичные частицы (Parent ID = 0): 2408 шагов
Вторичные частицы (Parent ID > 0): 2294520 шагов
Уникальных треков: 1064
Уникальных потоков: 32
Типы частиц: GenericIon, e, gamma

2. СТАТИСТИКА ПО ЧАСТИЦАМ
----------------------------------------------------------------------------------------------------

ПЕРВИЧНЫЕ ЧАСТИЦЫ:
--------------------------------------------------

  Частица: GenericIon
    Количество шагов: 2408
    Количество треков: 1
    Средняя кинетическая энергия: 40.886185 MeV
    Диапазон энергий: [0.000000, 150.000000] MeV
    Сумма dEStep (> 0): 16.316973 MeV
    Среднее dEStep (> 0): 0.012324 MeV

ВТОРИЧНЫЕ ЧАСТИЦЫ:
--------------------------------------------------

  Частица: e
    Количество шагов: 2282751
    Количество треков: 1062
    Средняя кинетическая энергия: 24.299841 MeV
    Диапазон энергий: [0.000000, 150.000000] MeV
    Сумма dEStep (> 0): 12958.126019 MeV
    Среднее dEStep (> 0): 0.010527 MeV

  Частица: gamma
    Количество шагов: 11769
    Количество треков: 387
    Средняя кинетическая энергия: 24.851444 MeV
    Диапазон энергий: [0.000000, 150.000000] MeV
    Сумма dEStep (> 0): 66.737166 MeV
    Среднее dEStep (> 0): 0.010452 MeV

3. ЭНЕРГЕТИЧЕСКИЙ БАЛАНС
----------------------------------------------------------------------------------------------------

ПЕРВИЧНЫЕ ЧАСТИЦЫ:
  Начальная энергия: 150.000000 MeV
  Конечная энергия: 140.600000 MeV
  Потерянная энергия: 9.400000 MeV
  Сумма всех dEStep: 16.316973 MeV
  Сумма положительных dEStep: 16.316973 MeV

ВТОРИЧНЫЕ ЧАСТИЦЫ:
  Начальная энергия: 19268.277674 MeV
  Конечная энергия: 3800.188947 MeV
  Потерянная энергия: 15468.088727 MeV
  Сумма всех dEStep: 13024.863185 MeV
  Сумма положительных dEStep: 13024.863185 MeV

4. СВЕРКА С ИТОГОВОЙ СВОДКОЙ
----------------------------------------------------------------------------------------------------
Energy deposit (из сводки): 23.528000 MeV
Energy leakage (из сводки): 127.760000 MeV
Сумма (E_deposit + E_leakage): 151.288000 MeV

⚠️  ВНИМАНИЕ: Лог неполный (пропущены шаги)!
Метод 1 (сумма dEStep) НЕ РАБОТАЕТ для неполных логов.
Используйте ТОЛЬКО Метод 2 (энергетический баланс).

Метод 1 (Сумма положительных dEStep - только потери энергии):
  Рассчитано: 13041.180158 MeV
  Абсолютная разница: 13017.652158 MeV
  Относительная разница: 55328.3414%
  ❌ НЕ ПРИМЕНИМО для этого лога (шаги пропущены)

Метод 2 (Начальная - Конечная энергия):
  Рассчитано: 15477.488727 MeV
  Абсолютная разница: 15453.960727 MeV
  Относительная разница: 65683.2741%

Проверка энергетического баланса первичных частиц:
  Начальная энергия первичных: 150.000000 MeV
  E_deposit + E_leakage:       151.288000 MeV
  Разница:                     1.288000 MeV (0.8587%)

✅ ОТЛИЧНО! Энергетический баланс первичных частиц сходится (<1%)

5. СРАВНЕНИЕ ЧАСТОТ ПРОЦЕССОВ
----------------------------------------------------------------------------------------------------
Процесс                        |    Парсинг |     Сводка |    Разница
----------------------------------------------------------------------------------------------------
initStep                       |     971261 |          0 |    +971261
ionIoni                        |     400839 |    1237964 |    -837125
eIoni                          |     915513 |    1649143 |    -733630
eBrem                          |       3483 |       7152 |      -3669
phot                           |       3923 |       6766 |      -2843
Transportation                 |          0 |       1682 |      -1682
msc                            |       1281 |       2940 |      -1659
rms                            |          0 |        918 |       -918
OutOfWorld                     |        596 |          0 |       +596
Rayl                           |         26 |         41 |        -15
ionElastic                     |          3 |         16 |        -13
Range                          |          0 |          9 |         -9
simulation                     |          0 |          4 |         -4
compt                          |          3 |          5 |         -2
end                            |          0 |          2 |         -2
true                           |          0 |          0 |         +0

6. ИНТЕРПРЕТАЦИЯ РЕЗУЛЬТАТОВ
----------------------------------------------------------------------------------------------------

ДВА МЕТОДА ПРОВЕРКИ ЭНЕРГЕТИЧЕСКОГО БАЛАНСА:

МЕТОД 1: Сумма потерь энергии (dEStep)
  • Суммирует все положительные значения dEStep из шагов
  • Работает ТОЛЬКО если ВСЕ шаги записаны в лог
  • ❌ НЕ РАБОТАЕТ для неполных логов (когда пропущены шаги)
  • Причина: если часть шагов не залогирована, сумма будет неполной

МЕТОД 2: Энергетический баланс треков (Начальная - Конечная)
  • Использует начальную и конечную энергию каждого трека
  • ✅ РАБОТАЕТ даже для неполных логов
  • Более надежный метод, не зависит от логирования промежуточных шагов

ПРОВЕРКА ЭНЕРГЕТИЧЕСКОГО БАЛАНСА:
  • Начальная энергия первичных частиц должна равняться
    сумме Energy deposit + Energy leakage из итоговой сводки
  • Это фундаментальный закон сохранения энергии
  • Если разница <1%, энергетический баланс сходится отлично

----------------------------------------------------------------------------------------------------

Первичные частицы (Parent ID = 0):
  • Это исходные частицы, запущенные в симуляции
  • Их начальная энергия - это входная энергия симуляции

Вторичные частицы (Parent ID > 0):
  • Это частицы, рожденные в процессе взаимодействия первичных
  • Они могут создаваться через процессы: ionIoni, eBrem, compt, и др.
  • Их энергия изначально взята из первичных частиц

Energy deposit:
  • Энергия, поглощенная материалом (ионизация)
  • Вызывает повреждения в материале

Energy leakage:
  • Энергия частиц, покинувших объем симуляции
  • Не поглощается материалом

Возможные причины малых расхождений (<5%):
  1. Округления при конверсии единиц (eV ↔ keV ↔ MeV)
  2. Численная точность при расчетах в Geant4
  3. NIEL energy (неионизирующие потери энергии)
  4. Энергетические пороги отслеживания частиц

====================================================================================================