====================================================================================================
ОТЧЕТ ОБ АНАЛИЗЕ ЛОГОВ GEANT4
====================================================================================================
Входной файл: logs/main120407.log
Дата анализа: 2025-10-31 01:29:23

1. ОБЩАЯ СТАТИСТИКА
----------------------------------------------------------------------------------------------------
Всего шагов: 4056
Первичные частицы (Parent ID = 0): 3092 шагов
Вторичные частицы (Parent ID > 0): 964 шагов
Уникальных треков: 9
Уникальных потоков: 32
Типы частиц: gamma, e

2. СТАТИСТИКА ПО ЧАСТИЦАМ
----------------------------------------------------------------------------------------------------

ПЕРВИЧНЫЕ ЧАСТИЦЫ:
--------------------------------------------------

  Частица: gamma
    Количество шагов: 3092
    Количество треков: 1
    Средняя кинетическая энергия: 0.923463 MeV
    Диапазон энергий: [0.000000, 1.330000] MeV
    Сумма dEStep (> 0): 76.456872 MeV
    Среднее dEStep (> 0): 0.048116 MeV

ВТОРИЧНЫЕ ЧАСТИЦЫ:
--------------------------------------------------

  Частица: e
    Количество шагов: 771
    Количество треков: 8
    Средняя кинетическая энергия: 0.871260 MeV
    Диапазон энергий: [0.000000, 1.330000] MeV
    Сумма dEStep (> 0): 21.625523 MeV
    Среднее dEStep (> 0): 0.053929 MeV

  Частица: gamma
    Количество шагов: 193
    Количество треков: 6
    Средняя кинетическая энергия: 0.852526 MeV
    Диапазон энергий: [0.000000, 1.330000] MeV
    Сумма dEStep (> 0): 6.384777 MeV
    Среднее dEStep (> 0): 0.062596 MeV

3. ЭНЕРГЕТИЧЕСКИЙ БАЛАНС
----------------------------------------------------------------------------------------------------

ПЕРВИЧНЫЕ ЧАСТИЦЫ:
  Начальная энергия: 1.330000 MeV
  Конечная энергия: 1.330000 MeV
  Потерянная энергия: 0.000000 MeV
  Сумма всех dEStep: 76.456872 MeV
  Сумма положительных dEStep: 76.456872 MeV

ВТОРИЧНЫЕ ЧАСТИЦЫ:
  Начальная энергия: 8.108200 MeV
  Конечная энергия: 4.229250 MeV
  Потерянная энергия: 3.878950 MeV
  Сумма всех dEStep: 28.010300 MeV
  Сумма положительных dEStep: 28.010300 MeV

4. СВЕРКА С ИТОГОВОЙ СВОДКОЙ
----------------------------------------------------------------------------------------------------
Energy deposit (из сводки): 0.133580 MeV
Energy leakage (из сводки): 1.196400 MeV
Сумма (E_deposit + E_leakage): 1.329980 MeV

⚠️  ВНИМАНИЕ: Лог неполный (пропущены шаги)!
Метод 1 (сумма dEStep) НЕ РАБОТАЕТ для неполных логов.
Используйте ТОЛЬКО Метод 2 (энергетический баланс).

Метод 1 (Сумма положительных dEStep - только потери энергии):
  Рассчитано: 104.467172 MeV
  Абсолютная разница: 104.333592 MeV
  Относительная разница: 78105.6981%
  ❌ НЕ ПРИМЕНИМО для этого лога (шаги пропущены)

Метод 2 (Начальная - Конечная энергия):
  Рассчитано: 3.878950 MeV
  Абсолютная разница: 3.745370 MeV
  Относительная разница: 2803.8404%

Проверка энергетического баланса первичных частиц:
  Начальная энергия первичных: 1.330000 MeV
  E_deposit + E_leakage:       1.329980 MeV
  Разница:                     0.000020 MeV (0.0015%)

✅ ОТЛИЧНО! Энергетический баланс первичных частиц сходится (<1%)

5. СРАВНЕНИЕ ЧАСТОТ ПРОЦЕССОВ
----------------------------------------------------------------------------------------------------
Процесс                        |    Парсинг |     Сводка |    Разница
----------------------------------------------------------------------------------------------------
initStep                       |       1193 |          0 |      +1193
Transportation                 |          0 |        988 |       -988
OutOfWorld                     |        766 |          0 |       +766
CoulombScat                    |        945 |       1211 |       -266
eIoni                          |        650 |        822 |       -172
msc                            |        250 |        332 |        -82
compt                          |        155 |        189 |        -34
phot                           |         66 |         90 |        -24
eBrem                          |         23 |         35 |        -12
Range                          |          0 |          9 |         -9
simulation                     |          0 |          4 |         -4
end                            |          0 |          3 |         -3
rms                            |          0 |          2 |         -2
Rayl                           |          5 |          6 |         -1
annihil                        |          1 |          1 |         +0
true                           |          0 |          0 |         +0
conv                           |          2 |          2 |         +0

6. ИНТЕРПРЕТАЦИЯ РЕЗУЛЬТАТОВ
----------------------------------------------------------------------------------------------------

ДВА МЕТОДА ПРОВЕРКИ ЭНЕРГЕТИЧЕСКОГО БАЛАНСА:

МЕТОД 1: Сумма потерь энергии (dEStep)
  • Суммирует все положительные значения dEStep из шагов
  • Работает ТОЛЬКО если ВСЕ шаги записаны в лог
  • ❌ НЕ РАБОТАЕТ для неполных логов (когда пропущены шаги)
  • Причина: если часть шагов не залогирована, сумма будет неполной

МЕТОД 2: Энергетический баланс треков (Начальная - Конечная)
  • Использует начальную и конечную энергию каждого трека
  • ✅ РАБОТАЕТ даже для неполных логов
  • Более надежный метод, не зависит от логирования промежуточных шагов

ПРОВЕРКА ЭНЕРГЕТИЧЕСКОГО БАЛАНСА:
  • Начальная энергия первичных частиц должна равняться
    сумме Energy deposit + Energy leakage из итоговой сводки
  • Это фундаментальный закон сохранения энергии
  • Если разница <1%, энергетический баланс сходится отлично

----------------------------------------------------------------------------------------------------

Первичные частицы (Parent ID = 0):
  • Это исходные частицы, запущенные в симуляции
  • Их начальная энергия - это входная энергия симуляции

Вторичные частицы (Parent ID > 0):
  • Это частицы, рожденные в процессе взаимодействия первичных
  • Они могут создаваться через процессы: ionIoni, eBrem, compt, и др.
  • Их энергия изначально взята из первичных частиц

Energy deposit:
  • Энергия, поглощенная материалом (ионизация)
  • Вызывает повреждения в материале

Energy leakage:
  • Энергия частиц, покинувших объем симуляции
  • Не поглощается материалом

Возможные причины малых расхождений (<5%):
  1. Округления при конверсии единиц (eV ↔ keV ↔ MeV)
  2. Численная точность при расчетах в Geant4
  3. NIEL energy (неионизирующие потери энергии)
  4. Энергетические пороги отслеживания частиц

====================================================================================================